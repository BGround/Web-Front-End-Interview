# 计算机网络及实践 知识点总结

本部分主要是笔者在复习 计算机网络及实践 相关知识和一些相关面试题时所做的笔记，如果出现错误，希望大家指出！


### 目录
### HTTP协议
- [URI和URL以及URN分别是什么](#URI和URL以及URN分别是什么)
- [常见的HTTP请求](#常见的HTTP请求)
- [HTTP1.0和1.1之间的区别](#HTTP1.0和1.1之间的区别)
- [HTTP1.1和2.0之间的区别](#HTTP1.1和2.0之间的区别)
- [HTTP和HTTPS协议的区别](#HTTP和HTTPS协议的区别)
- [与缓存相关的HTTP请求头有哪些](#与缓存相关的HTTP请求头有哪些)
- [强缓存和协商缓存的使用](#强缓存和协商缓存的使用)
- [Http请求详解关于cache和cookie](#Http请求详解关于cache和cookie)
- [Http请求中GET和POST本质区别](#Http请求中GET和POST本质区别)
- [客户端如何验证证书的合法性](#客户端如何验证证书的合法性)

### HTTPS协议


### HTTP状态码
- [HTTP常见的状态码](#HTTP常见的状态码)

### TCP和UDP
- [UDP协议,TCP和HTTP协议](#UDP协议-TCP和HTTP协议)
- [TCP三次握手和四次挥手](#TCP三次握手和四次挥手)


#### URI和URL以及URN分别是什么
1. URI: Universal Resource Identifer 统一资源标识符，
2. URL: Universal Resource Locator 统一资源定位符，代表资源的路径地址
3. URN: Universal Resource Name 统一资源名称，代表着资源的名称

URN 和 URL 都是 URI 的子集

**[:arrow_up: 返回目录](#目录)**

#### 常见的HTTP请求
* GET: 向服务器获取数据
* POST: 将实体提交到指定服务器，通常会造成服务器资源的修改
* PUT: 上传文件，修改数据
* DELETE: 删除服务器的对象
* HEAD: 获取报文首部，与GET相比，不返回报文主体部分
* OPTIONS: 询问支持的请求方法，用来跨域请求
* TRACE: 追踪，请求，响应的传输路径
* CONNECT: 要求与代理服务器通信时建立隧道，使用隧道进行TCP通信

**[:arrow_up: 返回目录](#目录)**

#### HTTP1.0和1.1之间的区别
1. 连接方面: http1.1是持久连接，而http1.0是非持久连接。1.1是多个http请求复用一个TCP连接
2. 缓存方面: http1.0主要使用header里的if-Modified-Since,Expries来做缓存判断的标准，http1.1则引入了更多的缓存策略如: Etag、if-Unmodified-Since
if-match、if-None-Match等更多可供选择
3. 资源请求方面: http1.1在请求头引入了range头域，允许只请求资源的某一个部分，即返回码是206，节省了带宽和资源利用
4. 请求方法: http1.1相对与1.0还新增了很多请求方法，如PUT、HEAD、OPTIONS等
5. http1.1还新增了host字段，用来指定服务器的域名。

**[:arrow_up: 返回目录](#目录)**

#### HTTP1.1和2.0之间的区别
1. 二进制协议: http2.0是一个二进制协议，http1.1报文的头部是(ASCII码)，数据体是二进制，可以是文本。2.0的头信息和数据体都是二进制，统称为'帧'
2. HTTP/2 复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应，这样就避免了”队头堵塞”。
3. 可以设置请求的优先级，HTTP/2 提供了请求优先级，可以在发送请求时，标上该请求的优先级，这样服务器接收到请求之后，会优先处理优先级高的请求
4. 头信息压缩: 头信息使用gzip或者compress压缩一些头信息，如cookies或者User Agent等一摸一样的内容
5. 服务器推送: http2下服务器主动推送的是静态资源，和websocket以及使用SSE等方式向客户端发送即时数据的推送是不同的

**[:arrow_up: 返回目录](#目录)**

#### HTTP和HTTPS协议的区别
主要区别如下
* HTTPS协议需要CA证书，价格比较昂贵
* 使用的连接方式不同，端口也不同，HTTPS端口是443，HTTP是80
* HTTP是超文本传输协议，信息是明文传输的，HTTPS则是更加安全的SSL加密传输协议
* HTTP协议连接很简单，是无状态的，HTTPS协议是SSL和HTTP协议构建的可进行加密传输、身份认证的网络协议，比HTTP更加安全


**[:arrow_up: 返回目录](#目录)**

#### 与缓存相关的HTTP请求头有哪些
**强缓存：**   -- 200
* Expires (http1.0)
* Cache-Control (http1.1) 优先级高于Expires

**协商缓存**    -- 304
* Etag  => If-None-Match
* Last-Modified => If-Modified-Since

**[:arrow_up: 返回目录](#目录)**

#### 强缓存和协商缓存的使用
两种缓存主要的区别是:
* 如果浏览器命中强缓存，则不需要给服务器发送请求；而协商缓存最终由服务器来决定是否使用缓存，即客户端与服务器之间存在一次通信
* 在chrome中强缓存的请求状态码返回是200(虽然没有发出真实的HTTP请求)；而协商缓存如果命中走缓存的话，状态码返回的是304(not modified)

请求流程: 


**[:arrow_up: 返回目录](#目录)**

#### UDP协议 TCP和HTTP协议
**UDP：把数据包送达应用程序**
IP 是非常底层的协议，只负责把数据包传送到对方电脑，但是对方电脑并不知道把数据包交给哪个程序，是交给浏览器还是交给王者荣耀？
因此，需要基于 IP 之上开发能和应用打交道的协议，最常见的是“用户数据包协议（User Datagram Protocol）”，简称 UDP。
UDP 中一个最重要的信息是端口号，端口号其实就是一个数字，每个想访问网络的程序都需要绑定一个端口号。
通过端口号 UDP 就能把指定的数据包发送给指定的程序了，所以 IP 通过 IP 地址信息把数据包发送给指定的电脑，而 UDP 通过端口号把数据包分发给正确的程序。和 IP 头一样，
端口号会被装进 UDP 头里面，UDP 头再和原始数据包合并组成新的 UDP 数据包。UDP 头中除了目的端口，还有源端口号等信息。
![UDP传输](https://static001.geekbang.org/resource/image/3e/ea/3edb673a43f23d84253c52124ce447ea.png)

**TCP：把数据完整地送达应用程序**
TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议
![一个TCP连接生命周期](https://static001.geekbang.org/resource/image/44/44/440ee50de56edc27c6b3c992b3a25844.png)

**HTTP协议**
HTTP协议和TCP协议都是TCP/IP协议簇的子集。

HTTP协议属于应用层，TCP协议属于传输层，HTTP协议位于TCP协议的上层。

请求方要发送的数据包，在应用层加上HTTP头以后会交给传输层的TCP协议处理，应答方接收到的数据包，在传输层拆掉TCP头以后交给应用层的HTTP协议处理。建立 TCP 连接后会顺序收发数据，请求方和应答方都必须依据 HTTP 规范构建和解析HTTP报文。

**[:arrow_up: 返回目录](#目录)**

#### Http请求详解关于cache和cookie
关于Http请求参照下面的流程图
![Http请求](https://static001.geekbang.org/resource/image/1b/6c/1b49976aca2c700883d48d927f48986c.png)

*(1)为什么通常在第一次访问一个站点时，打开速度很慢，当再次访问这个站点时，速度就很快了？*
>主要是第二次加载页面的过程中，缓存了一些耗时的数据，如DNS缓存和页面资源缓存。DNS缓存是浏览器本地把对应的IP和域名关联起来

>页面资源缓存是浏览器缓存数据到本地,当服务器返回HTTP响应头给浏览器时，浏览器是通过响应头中的Cache-control字段来设置是否
>缓存该资源，并用Max-age参数设置一个缓存过期时长，缓存资源未过期会直接返回缓存中的资源给浏览器，过期的话浏览器会继续发起网络请求
>并在HTTP请求头带上If-None-Match:"4f80f-13c-3a1xb12a",服务器收到请求头后，会根据 If-None-Match 的值来判断请求的资源是否有更新。
>如果没有更新，就返回 304 状态码，相当于服务器告诉浏览器：“这个缓存可以继续使用，这次就不重复发送数据给你了。”如果资源有更新，服务器就直接返回最新资源给浏览器。

![页面资源缓存](https://static001.geekbang.org/resource/image/5f/08/5fc2f88a04ee0fc41a808f3481287408.png)

*(2)登录状态是如何保持的？*


![Set-cookie](https://static001.geekbang.org/resource/image/d9/b3/d9d6cefe8d3d6d84a37a626687c6ecb3.png)

*(3)如果一个页面的网络加载时间过久，你是如何分析卡在哪个阶段的？*
>1 首先猜测最可能的出问题的地方，网络传输丢包比较严重，需要不断重传。然后通过ping curl看看对应的时延高不高。
>2 然后通过wireshake看看具体哪里出了问题。
>3 假如别人访问很快，自己电脑很慢，就要看看自己客户端是否有问题了

**[:arrow_up: 返回目录](#目录)**

#### Http请求中GET和POST本质区别
GET和POST是HTTP的两种请求方法，底层都是TCP/IP协议，但是有着本质的区别
 - 1.在URL上的区别
	* get请求只能进行url编码，post支持多种编码方式
	* get请求参数是在url上，post是在request body中
	* get的url长度是有限制的，而post没有(这里是浏览器或者web服务器导致)
	* 请求参数在url上，get更加不安全，可以作为Bookmark
 - 2.在缓存上面的区别
	* get 请求类似于查找的过程，用户获取数据，可以不用每次都与数据库连接，可以使用缓存
	* post 不同，post一般做的是修改或者删除的操作，所以必须与数据库交互，不能使用缓存。
	* get 在浏览器回退时是无害的，而post会再次提交请求

参考资料:《[GET和POST两种基本请求方法的区别](https://cnblogs.com/logsharing/p/8448446.html)》
**[:arrow_up: 返回目录](#目录)**

#### 5. TCP三次握手和四次挥手


**[:arrow_up: 返回目录](#目录)**

#### 客户端如何验证证书的合法性
HTTPS 数据安全传输中客户端如何验证证书的合法性
 * 客户端向服务端发起请求之后，服务端会返回数字证书给客户端
 * 先利用CA签名相同的Hash算法得到证书中的明文信息，得到摘要A
 * 再利用对应CA公钥解密签名数据，得到摘要B
 * 对比摘要A和B是否一致，可以判断服务器的合法性

**[:arrow_up: 返回目录](#目录)**

#### img iframe script 来发送跨域请求有什么优缺点
**iframe**
优点：跨域完毕之后DOM操作和互相之间的JavaScript调用都是没有问题的

缺点：1.若结果要以URL参数传递，这就意味着在结果数据量很大的时候需要分割传递，巨烦。2.还有一个是iframe本身带来的，母页面和iframe本身的交互本身就有安全性限制。

**script**
优点：可以直接返回json格式的数据，方便处理

缺点：只接受GET请求方式

**图片img**
优点：可以访问任何url，一般用来进行点击追踪，做页面分析常用的方法

缺点：不能访问响应文本，只能监听是否响应

**[:arrow_up: 返回目录](#目录)**

#### HTTP常见的状态码
状态码的类别：
* 1xx Information 信息类状态码，接受的请求正在处理
* 2xx Success 成功状态码，请求正常处理完毕
* 3xx Redirection 重定向状态码，需要进行附加操作完成请求
* 4xx Client Error 客户端操作状态码，服务器无法处理请求
* 5xx Server Error 服务器操作状态码，服务器处理请求错误

1. 2XX
(1) 200 OK 表示客户端发出的请求服务端正常处理了
(2) 204 Not Content 和200一样，只是不需要服务端向客户端返回内容

2. 3XX
(1) 301 Moved Permanently 永久重定向，该状态码表示请求的资源已经被分配了新的URI，以后使用资源指定的URI。新的URI会在HTTP响应头中的Location首部字段指定。
(2) 302 Found 临时移动，和301一样，但是302代表的资源不是被永久重定向，只是临时性质的。也就是说已移动的资源对应的URI还会改变
若用户把URI保存成书签，但不会像301状态码一样取更新书签，而是还保存原来的URI，同时搜索引擎会抓取新的内容而保留旧的网址
使用场景:
* 当我们在做活动时，登录到首页自动重定向，进入活动页面
* 为登录的用户访问用户中心重定向到登录页面
* 访问404页面重新定向到首页
(3) 303 See Other 查看其它地址。与301类似。**使用GET和POST请求查看**
(4) 304 Not Modified 浏览器缓存相关，和重定向没有关系。304不是一种错误，而是告诉客户端有缓存，直接使用缓存中的数据。
返回页面的只有头部信息，没有内容的部分，这在一定程度上提高了网页的性能
(5) 307 Temporary Redirect 临时重定向，**使用GET请求重定向**

注意：
302是http1.0的协议状态码，在http1.1版本的时候为了细化302状态码又出来了两个303和307。 
303明确表示客户端应当采用get方法获取资源，他会把POST请求变为GET请求进行重定向。 307会遵照浏览器标准，不会从post变为get。

3. 4XX
(1) 400 Bad Request 请求报文中存在语法错误，需要修改请求的内容后再次发送请求。
(2) 401 Unauthorized 请求要求用户进行身份认证
(3) 403 Forbidden 请求资源的访问被服务器拒绝了
(4) 404 Not Found 服务器上无法找到请求的资源

4. 5XX
(1) 500 Internal Server Error 服务器端在执行请求时发生了错误，也有可能时Web应用存在的bug或某些临时的故障
(2) 502 Bad Gateway 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应



